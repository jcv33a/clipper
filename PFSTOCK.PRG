*** MODIFY.PRG

PROCEDURE MODIFY

SET INDEX TO CLASE,REF

CLEAR

OPCION=SPACE(1)
@0,0 SAY "¨ORDENACION POR REFERENCIA? (N/S):" GET OPCION
READ

IF OPCION$"Ss"

        SET INDEX TO REF,CLASE

ENDIF

SET KEY 28 TO HELP

CLEAR

@0,0 SAY "[F1] = Ayuda"
BROWSE()

CLEAR

BORRAR=SPACE(1)
@0,0 SAY "¨QUIERE BORRAR LAS FICHAS MARCADAS? (N/S):" GET BORRAR
READ

IF BORRAR$"Ss"
        PACK
ENDIF

CLEAR

SET CURSOR OFF
SET CURSOR ON
SET KEY 28 TO

RETURN

*** MODSTOCK.PRG

PROCEDURE MODSTOCK

CLEAR

CONTINUAR=SPACE(1)
@0,0 SAY "¨QUIERE CONTINUAR? (N/S):" GET CONTINUAR
READ

IF CONTINUAR$"Ss"

        SET INDEX TO
        GO BOTTOM
        @2,0 SAY "ULTIMA REFERENCIA:" GET REF
        @3,0
        WAIT
        SET INDEX TO REF,CLASE

        STORE "S" TO SIG
        DO WHILE SIG$"Ss"

                STORE "N" TO SIG

                APPEND BLANK

                CLEAR

                @0,0 SAY "ENTRADA AL FICHERO DE STOCK"
                @2,0 SAY "REFERENCIA" GET REF
                @3,0 SAY "ARTICULO" GET COMENT1
                @4,0 SAY "CLASE" GET CLASE
                @5,0 SAY "PRIMERA LINEA DE DIRECCIONES" GET COMENT2
                @6,0 SAY "COSTE" GET COSTE
                READ
                @7,0 SAY "COSTE_8_7: "+STR(COSTE*1.08*1.07,8,2)
                @8,0 SAY "PV_20: "+STR(COSTE*1.08*1.07*1.2,8,2)
                @9,0 SAY "PV_30: "+STR(COSTE*1.08*1.07*1.3,8,2)
                @10,0 SAY "PVIR" GET PVIR
                @11,0 SAY "PVB" GET PVB
                @12,0 SAY "PVP" GET PVP
                @13,0 SAY "ESTADO ACTUAL" GET ACTUAL
                @14,0 SAY "¨PEDIR?" GET PEDIR
                @15,0 SAY "UNIDADES O KILOS A PEDIR" GET UNIDADES
                @16,0 SAY "¨CAJAS,KILOS,PIEZAS...?" GET TIPO

                READ

                IF PEDIR

                        REPLACE NUMERO WITH NUMERO+UNIDADES
                        REPLACE PEDIDO WITH PEDIDO+UNIDADES

                ENDIF

                @18,0 SAY "¨QUIERE INTRODUCIR OTRA FICHA? (S/N): " GET SIG

                READ

        ENDDO

ENDIF

RETURN

*** STOCKENT.PRG

PROCEDURE STOCKENT

STORE "S" TO SIG
DO WHILE SIG$"Ss"

        CLEAR
        INCREMENTO=0

        PIEZA=SPACE(6)
        @0,0 SAY "REFERENCIA:" GET PIEZA
        READ

        FIND &PIEZA
        @2,0 SAY "REFERENCIA" GET REF
        @3,0 SAY "ARTICULO" GET COMENT1
        @4,0 SAY "CLASE" GET CLASE
        @5,0 SAY "PRIMERA LINEA DE DIRECCIONES" GET COMENT2
        @6,0 SAY "COSTE" GET COSTE
        READ
        @7,0 SAY "COSTE_8_7: "+STR(COSTE*1.08*1.07,8,2)
        @8,0 SAY "PV_20: "+STR(COSTE*1.08*1.07*1.2,8,2)
        @9,0 SAY "PV_30: "+STR(COSTE*1.08*1.07*1.3,8,2)
        @10,0 SAY "PVIR" GET PVIR
        @11,0 SAY "PVB" GET PVB
        @12,0 SAY "PVP" GET PVP
        @13,0 SAY "ESTADO ACTUAL" GET ACTUAL
        @14,0 SAY "¨PEDIR?" GET PEDIR
        @15,0 SAY "UNIDADES O KILOS A PEDIR" GET UNIDADES
        @16,0 SAY "¨CAJAS,KILOS,PIEZAS...?" GET TIPO

        READ

        IF PEDIR

                REPLACE NUMERO WITH NUMERO+UNIDADES
                REPLACE PEDIDO WITH PEDIDO+UNIDADES

        ENDIF

        @18,0 SAY "¨DESEA MODIFICAR OTRO PRODUCTO? (S/N): " GET SIG

        READ

ENDDO

RETURN

*** STOCKBAJ.PRG

PROCEDURE STOCKBAJ

OPCION=SPACE(1)
IMPRIMIR=SPACE(1)

set index to clase

CLEAR

REPORT FORM lisact FOR PEDIR to file ofertas.txt
?
WAIT

CLEAR

@0,0 SAY "¨QUIERES IMPRIMIRLO? (N/S):" GET IMPRIMIR
READ

IF IMPRIMIR$"Ss"

        REPORT FORM lisact FOR PEDIR NOEJECT TO PRINT
        ?

ENDIF

CLEAR
WAIT
RETURN

*** LISACT.PRG

PROCEDURE LISACT

OPCION=SPACE(1)
IMPRIMIR=SPACE(1)

SET INDEX TO CLASE

CLEAR

REPORT FORM LISACT FOR ACTUAL to file lisact.txt
?
WAIT

CLEAR

@0,0 SAY "¨QUIERES IMPRIMIRLO? (N/S):" GET IMPRIMIR
READ

IF IMPRIMIR$"Ss"

        REPORT FORM LISACT FOR ACTUAL NOEJECT TO PRINT
        ?

ENDIF

CLEAR
WAIT
RETURN
